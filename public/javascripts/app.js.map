{"version":3,"file":"public/javascripts/app.js","sources":["app/geometryBuilder.coffee","app/imageRetriever.coffee","app/importer.coffee","app/initialize.coffee","app/lib/app_helpers.coffee","app/lib/view.coffee","app/lib/view_collection.coffee","app/pack_hierarchy.coffee","app/routers/app_router.coffee","app/sceneKeeper.coffee","app/views/app_view.coffee","app/visualStructure.coffee"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3HA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1JA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1EA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3EA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAfA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA7CA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1IA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzGA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA9XA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1BA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1DA;;A","sourcesContent":["var GeometryBuilder;\n\nGeometryBuilder = (function() {\n  function GeometryBuilder() {\n    this.artistGeometry = new THREE.CubeGeometry(1, 1, 1);\n    this.workGeometry = new THREE.PlaneGeometry(1, 40);\n    this.scaleX = 400;\n    this.scaleY = 40;\n  }\n\n  GeometryBuilder.prototype.selectedArtistMesh = function(artist) {\n    var selectedArtistMaterial;\n    selectedArtistMaterial = new THREE.MeshLambertMaterial({\n      opacity: 0.70,\n      wireframe: false,\n      transparent: true\n    });\n    return this.artistMesh(artist, selectedArtistMaterial, 1.50);\n  };\n\n  GeometryBuilder.prototype.artistMesh = function(artist, texture, multiplier) {\n    var mesh;\n    if (multiplier == null) {\n      multiplier = 0;\n    }\n    mesh = new THREE.Mesh(this.artistGeometry, texture);\n    mesh.position.set(artist._x * this.scaleX, artist._y * this.scaleY, 0);\n    mesh.scale.x = (artist._width * this.scaleX) + (artist._height * multiplier);\n    mesh.scale.y = (artist._height * this.scaleY) + (artist._height * multiplier);\n    mesh.scale.z = (1 + artist._height * this.scaleY * 10) + (artist._height * multiplier);\n    return mesh;\n  };\n\n  GeometryBuilder.prototype.build = function(scene, data) {\n    var artist, currentArtist, face, gender, geometry, line, lineMaterial, materialProperties, mesh, offset, _i, _j, _k, _len, _len1, _len2, _ref, _ref1, _ref2;\n    this.scene = scene;\n    this.data = data;\n    this.collatedArtistGeometries = [new THREE.Geometry(), new THREE.Geometry(), new THREE.Geometry()];\n    this.collatedWorkGeometry = new THREE.Geometry();\n    this.data.artists.forEach((function(_this) {\n      return function(artist) {\n        var face, mesh, _i, _len, _ref;\n        mesh = _this.artistMesh(artist);\n        _ref = mesh.geometry.faces;\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          face = _ref[_i];\n          face.color.r = artist.id;\n        }\n        THREE.GeometryUtils.merge(_this.collatedArtistGeometries[artist.gender], mesh);\n        return artist.works.forEach(function(work) {\n          var v1, v2;\n          if (!work.invalid) {\n            v1 = new THREE.Vector3();\n            v1.set((work._x - work._width / 2) * _this.scaleX, work._y * _this.scaleY, (mesh.scale.z / 2) + 1);\n            v2 = new THREE.Vector3();\n            v2.set((work._x + work._width / 2) * _this.scaleX, work._y * _this.scaleY, (mesh.scale.z / 2) + 1);\n            _this.collatedWorkGeometry.vertices.push(v1);\n            return _this.collatedWorkGeometry.vertices.push(v2);\n          }\n        });\n      };\n    })(this));\n    materialProperties = {};\n    currentArtist = 0;\n    offset = 0;\n    _ref = this.collatedArtistGeometries;\n    for (gender = _i = 0, _len = _ref.length; _i < _len; gender = ++_i) {\n      geometry = _ref[gender];\n      _ref1 = geometry.faces;\n      for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {\n        face = _ref1[_j];\n        artist = face.color.r;\n        if (offset === 0) {\n          this.data.artistsKeyed[artist].focusFace = face;\n        }\n        offset += 1;\n        if (currentArtist !== artist) {\n          offset = 0;\n          currentArtist = artist;\n          this.data.artistsKeyed[artist].faces = [];\n        }\n        this.data.artistsKeyed[artist].faces.push(face);\n      }\n    }\n    _ref2 = this.collatedArtistGeometries;\n    for (gender = _k = 0, _len2 = _ref2.length; _k < _len2; gender = ++_k) {\n      geometry = _ref2[gender];\n      switch (gender) {\n        case 0:\n          materialProperties.color = \"#346\";\n          break;\n        case 1:\n          materialProperties.color = \"#3058c0\";\n          break;\n        case 2:\n          materialProperties.color = \"#ff7060\";\n      }\n      mesh = new THREE.Mesh(geometry, new THREE.MeshLambertMaterial(materialProperties));\n      mesh.material.ambient = mesh.material.color;\n      mesh.material.shinyness = 1;\n      mesh.castShadow = true;\n      mesh.receiveShadow = true;\n      this.scene.add(mesh);\n    }\n    lineMaterial = new THREE.LineBasicMaterial({\n      color: 0xffffff,\n      opacity: 0.01,\n      blending: THREE.AdditiveBlending,\n      linewidth: 0.1\n    });\n    line = new THREE.Line(this.collatedWorkGeometry, lineMaterial, THREE.LinePieces);\n    return this.scene.add(line);\n  };\n\n  GeometryBuilder.prototype.yearToFloat = function(year) {\n    return (year - this.startYear) / this.endYear;\n  };\n\n  return GeometryBuilder;\n\n})();\n\nmodule.exports = new GeometryBuilder;\n","var ImageRetriever,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\nImageRetriever = (function() {\n  var baseURL;\n\n  baseURL = \"http://api.digitaltmuseum.no/artifact?owner=NMK-B&mapping=ESE&api.key=demo&identifier=\";\n\n  function ImageRetriever() {\n    this.previousBlock = __bind(this.previousBlock, this);\n    this.nextBlock = __bind(this.nextBlock, this);\n    $(\".imageContainer\").on(\"mouseleave\", function(event) {\n      $(\".zoomedImageContainer\").hide();\n      $(\".photographer\").text(\"\");\n      return $(\".title\").text(\"\");\n    });\n    $(\".navBlock .next\").click(this.nextBlock);\n    $(\".navBlock .prev\").click(this.previousBlock);\n    this.maxImages = 30;\n  }\n\n  ImageRetriever.prototype.getImages = function(artist) {\n    this.clear();\n    this.works = artist.works;\n    this.works = this.works.sort(function(a, b) {\n      return a.kind < b.kind;\n    });\n    this.works = this.works.filter(function(a) {\n      return a.imageCount > 0;\n    });\n    if (this.works.length === 0) {\n      $('.imageContainer').hide();\n      return;\n    }\n    this.currentOffset = 0;\n    this.sheetNumber = 1;\n    this.getImageBlock(this.works.slice(this.currentOffset, this.currentOffset + this.maxImages));\n    this.updateDisplay();\n    if (this.works.length < this.maxImages) {\n      $('.navBlock').hide();\n    } else {\n      $('.navBlock').show();\n    }\n    return $('.imageContainer').show();\n  };\n\n  ImageRetriever.prototype.updateDisplay = function() {\n    if (this.works.length > 0) {\n      $('.navBlock p.counter').text(this.sheetNumber + \" / \" + (Math.ceil(this.works.length / this.maxImages)));\n    } else {\n      $('.navBlock p.counter').text(\"\");\n    }\n    if (this.currentOffset === 0) {\n      $('.navBlock .prev').addClass(\"deactivated\");\n    } else {\n      $('.navBlock .prev').removeClass(\"deactivated\");\n    }\n    if (this.currentOffset + this.maxImages >= this.works.length) {\n      return $('.navBlock .next').addClass(\"deactivated\");\n    } else {\n      return $('.navBlock .next').removeClass(\"deactivated\");\n    }\n  };\n\n  ImageRetriever.prototype.nextBlock = function(event) {\n    event.stopPropagation();\n    if (this.currentOffset + this.maxImages >= this.works.length) {\n      return;\n    }\n    this.currentOffset += this.maxImages;\n    this.sheetNumber += 1;\n    this.clear();\n    this.getImageBlock(this.works.slice(this.currentOffset, this.currentOffset + this.maxImages));\n    return this.updateDisplay();\n  };\n\n  ImageRetriever.prototype.previousBlock = function(event) {\n    event.stopPropagation();\n    if (this.currentOffset === 0) {\n      return;\n    }\n    this.currentOffset -= this.maxImages;\n    this.sheetNumber -= 1;\n    this.clear();\n    this.getImageBlock(this.works.slice(this.currentOffset, this.currentOffset + this.maxImages));\n    return this.updateDisplay();\n  };\n\n  ImageRetriever.prototype.getImageBlock = function(works) {\n    var image, work, _i, _len, _results;\n    _results = [];\n    for (_i = 0, _len = works.length; _i < _len; _i++) {\n      work = works[_i];\n      image = new Image();\n      image.src = \"data/images_lores_2/\" + work.id + \"_0.JPG\";\n      image.work = work;\n      _results.push(image.addEventListener(\"load\", function(event) {\n        $(\".imageContainerInner\").append(this);\n        this.addEventListener(\"click\", function(event) {\n          return event.stopPropagation();\n        });\n        return this.addEventListener(\"mouseenter\", function(event) {\n          $(\".zoomedImage\").attr(\"src\", \"data/images/\" + this.work.id + \"_0.JPG\");\n          $(\".zoomedImageContainer\").show();\n          $(\".photographer\").text(\"Imaging by \" + this.work.photographer);\n          $(\".title\").text(\"\");\n          return $.get(baseURL + this.work.id, {}, (function(_this) {\n            return function(xml) {\n              var engTitle, n, norTitle, title;\n              xml = $(xml);\n              n = xml.find(\"dc\\\\:title, title\");\n              engTitle = norTitle = void 0;\n              n.each(function(n, m) {\n                var title;\n                title = $(m);\n                if (title.context.outerHTML.indexOf(\"xml:lang=\\\"NOR\\\"\") >= 0) {\n                  norTitle = title.text();\n                }\n                if (title.context.outerHTML.indexOf(\"xml:lang=\\\"ENG\\\"\") >= 0) {\n                  return engTitle = title.text();\n                }\n              });\n              title = engTitle;\n              title || (title = norTitle);\n              if (title == null) {\n                title = \"Archive reference: \" + _this.work.id;\n                $(\".title\").addClass(\"onlyReference\");\n              } else {\n                $(\".title\").removeClass(\"onlyReference\");\n              }\n              return $(\".title\").text(title);\n            };\n          })(this));\n        });\n      }));\n    }\n    return _results;\n  };\n\n  ImageRetriever.prototype.clear = function() {\n    $(\".imageContainerInner\").empty();\n    $(\".zoomedImageContainer\").hide();\n    $(\".photographer\").text(\"\");\n    $(\".title\").text(\"\");\n    $('.navBlock .prev').removeClass(\"deactivated\");\n    $('.navBlock .prev').removeClass(\"deactivated\");\n    return $('.navBlock p.counter').text(\"\");\n  };\n\n  return ImageRetriever;\n\n})();\n\nmodule.exports = new ImageRetriever;\n","var Importer;\n\nImporter = (function() {\n  function Importer() {\n    this.data = {\n      artistsKeyed: {},\n      works: []\n    };\n  }\n\n  Importer.prototype.load = function() {\n    var artistsLoaded, photographers;\n    artistsLoaded = $.Deferred();\n    photographers = [\"Morten Thorkildsen\", \"Børre Høstland\", \"Jeanette Veiby\", \"Frode Larsen\", \"Anne Hansteen Jarre\", \"Dag A. Ivarsøy\", \"Therese Husby\", \"Dag Andre Ivarsøy\", \"Jacques Lathion\", \"Børre Høstland\", \"Andreas Harvik\", \"Ukjent\", \"Stein Jorgensen\", \"Øyvind Andersen\", \"Jaques Lathion\", \"Ole Henrik Storeheier\", \"Dag A, Ivarsøy\", \"Anne Hansteen\", \"Ukjent\", \"Scanned by Dag A. Ivarsøy\", \"Børre Høstland/ Andreas Harvik\", \"Annar Bjørgli\", \"Angela Musil-Jantjes\", \"Ukjent\", \"Stein Jørgensen\", \"Knut Øystein Nerdrum\", \"Børre Høstland\", \"Knut Øystein Nerdrum\"];\n    d3.csv(\"data/artists.csv\", (function(_this) {\n      return function(err, rows) {\n        rows.forEach(function(row) {\n          row.works = [];\n          row.id = +row.id;\n          row.gender = +row.gender;\n          row.dob = +row.dob;\n          row.dod = +row.dod;\n          _this.data.artistsKeyed[row.id] = row;\n          if (row.dob === row.dod) {\n            return row.dod += 1;\n          }\n        });\n        _this.data.artists = rows;\n        return artistsLoaded.resolve();\n      };\n    })(this));\n    artistsLoaded.then((function(_this) {\n      return function() {\n        return d3.csv(\"data/works_coded.csv\", function(err, rows) {\n          rows.forEach(function(row) {\n            var value;\n            row.artistId = +row.artistId;\n            row.produced = +row.produced;\n            row.acquired = +row.acquired;\n            row.invalid = row.produced === 0 || row.acquired === 0;\n            if (row.photographer_id !== \"-1\") {\n              row.photographer = photographers[row.photographer_id] + \" / Nasjonalmuseet\";\n            } else {\n              row.photographer = \"Nasjonalmuseet\";\n            }\n            value = _this.data.artistsKeyed[row[\"artistId\"]];\n            if (value != null) {\n              _this.data.artistsKeyed[row[\"artistId\"]].works.push(row);\n              return _this.data.works.push(row);\n            }\n          });\n          _this.data.artists = _.sortBy(_this.data.artists, function(artist) {\n            return artist.dob;\n          });\n          _this.data.artists.forEach(function(artist, i) {\n            return artist.index = i;\n          });\n          _this.data.artists.forEach(function(artist) {\n            return artist.works = _.sortBy(artist.works, function(work) {\n              return work.produced;\n            });\n          });\n          return _this.dataLoaded.resolve(_this.data);\n        });\n      };\n    })(this));\n    return this.dataLoaded = $.Deferred();\n  };\n\n  return Importer;\n\n})();\n\nmodule.exports = new Importer;\n","var $warnings, activateClass;\n\nif (this.Hipster == null) {\n  this.Hipster = {};\n}\n\nif (Hipster.Routers == null) {\n  Hipster.Routers = {};\n}\n\nif (Hipster.Views == null) {\n  Hipster.Views = {};\n}\n\nif (Hipster.Models == null) {\n  Hipster.Models = {};\n}\n\nif (Hipster.Collections == null) {\n  Hipster.Collections = {};\n}\n\n$warnings = $('.warnings');\n\nactivateClass = (function() {\n  var isMobile;\n  isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent);\n  if (Detector.webgl) {\n    if (!isMobile && navigator.userAgent.match(/Chrom(e|ium)/)) {\n      return '.shouldWork';\n    }\n    return '.maybeWork';\n  } else {\n    if (isMobile) {\n      return '.cantWorkMobile';\n    }\n    return '.cantWork';\n  }\n})();\n\n$(function() {\n  var AppView, data, importer, sceneKeeper;\n  require('../lib/app_helpers');\n  importer = require('./importer');\n  sceneKeeper = require('./sceneKeeper');\n  Hipster.Views.AppView = new (AppView = require('views/app_view'));\n  Backbone.history.start({\n    pushState: true\n  });\n  $warnings.find(activateClass).addClass('active');\n  return data = importer.load().then(function(data) {\n    $('.intro .button').text(\"Start\");\n    $('.intro .button').removeClass(\"deactivated\");\n    $('.intro .button').click((function(_this) {\n      return function() {\n        $('.intro').hide();\n        $('.warnings').hide();\n        sceneKeeper.init(data);\n        return $('body').addClass('activated');\n      };\n    })(this));\n    $('.showNavigation').click((function(_this) {\n      return function() {\n        $('.copy.overview').hide();\n        return $('.copy.navigation').show();\n      };\n    })(this));\n    return $('.showOverview').click((function(_this) {\n      return function() {\n        $('.copy.overview').show();\n        return $('.copy.navigation').hide();\n      };\n    })(this));\n  });\n});\n","(function() {\n  Swag.Config.partialsPath = '../views/templates/';\n  return (function() {\n    var console, dummy, method, methods, _results;\n    console = window.console = window.console || {};\n    method = void 0;\n    dummy = function() {};\n    methods = 'assert,count,debug,dir,dirxml,error,exception, group,groupCollapsed,groupEnd,info,log,markTimeline, profile,profileEnd,time,timeEnd,trace,warn'.split(',');\n    _results = [];\n    while (method = methods.pop()) {\n      _results.push(console[method] = console[method] || dummy);\n    }\n    return _results;\n  })();\n})();\n","var View,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = View = (function(_super) {\n  __extends(View, _super);\n\n  function View() {\n    return View.__super__.constructor.apply(this, arguments);\n  }\n\n  View.prototype.tagName = 'section';\n\n  View.prototype.template = function() {};\n\n  View.prototype.initialize = function() {\n    return this.render();\n  };\n\n  View.prototype.getRenderData = function() {\n    var _ref;\n    return (_ref = this.model) != null ? _ref.toJSON() : void 0;\n  };\n\n  View.prototype.render = function() {\n    this.beforeRender();\n    this.$el.html(this.template(this.getRenderData()));\n    this.afterRender();\n    return this;\n  };\n\n  View.prototype.beforeRender = function() {};\n\n  View.prototype.afterRender = function() {};\n\n  View.prototype.destroy = function() {\n    this.undelegateEvents();\n    this.$el.removeData().unbind();\n    this.remove();\n    return Backbone.View.prototype.remove.call(this);\n  };\n\n  return View;\n\n})(Backbone.View);\n","var View, ViewCollection, methods,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nView = require('./view');\n\nViewCollection = (function(_super) {\n  __extends(ViewCollection, _super);\n\n  function ViewCollection() {\n    this.renderOne = __bind(this.renderOne, this);\n    return ViewCollection.__super__.constructor.apply(this, arguments);\n  }\n\n  ViewCollection.prototype.collection = new Backbone.Collection();\n\n  ViewCollection.prototype.view = new View();\n\n  ViewCollection.prototype.views = [];\n\n  ViewCollection.prototype.length = function() {\n    return this.views.length;\n  };\n\n  ViewCollection.prototype.add = function(views, options) {\n    var view, _i, _len;\n    if (options == null) {\n      options = {};\n    }\n    views = _.isArray(views) ? views.slice() : [views];\n    for (_i = 0, _len = views.length; _i < _len; _i++) {\n      view = views[_i];\n      if (!this.get(view.cid)) {\n        this.views.push(view);\n        if (!options.silent) {\n          this.trigger('add', view, this);\n        }\n      }\n    }\n    return this;\n  };\n\n  ViewCollection.prototype.get = function(cid) {\n    return this.find(function(view) {\n      return view.cid === cid;\n    }) || null;\n  };\n\n  ViewCollection.prototype.remove = function(views, options) {\n    var view, _i, _len;\n    if (options == null) {\n      options = {};\n    }\n    views = _.isArray(views) ? views.slice() : [views];\n    for (_i = 0, _len = views.length; _i < _len; _i++) {\n      view = views[_i];\n      this.destroy(view);\n      if (!options.silent) {\n        this.trigger('remove', view, this);\n      }\n    }\n    return this;\n  };\n\n  ViewCollection.prototype.destroy = function(view, options) {\n    var _views;\n    if (view == null) {\n      view = this;\n    }\n    if (options == null) {\n      options = {};\n    }\n    _views = this.filter(_view)(function() {\n      return view.cid !== _view.cid;\n    });\n    this.views = _views;\n    view.undelegateEvents();\n    view.$el.removeData().unbind();\n    view.remove();\n    Backbone.View.prototype.remove.call(view);\n    if (!options.silent) {\n      this.trigger('remove', view, this);\n    }\n    return this;\n  };\n\n  ViewCollection.prototype.reset = function(views, options) {\n    var view, _i, _j, _len, _len1, _ref;\n    if (options == null) {\n      options = {};\n    }\n    views = _.isArray(views) ? views.slice() : [views];\n    _ref = this.views;\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      view = _ref[_i];\n      this.destroy(view, options);\n    }\n    if (views.length !== 0) {\n      for (_j = 0, _len1 = views.length; _j < _len1; _j++) {\n        view = views[_j];\n        this.add(view, options);\n      }\n      if (!options.silent) {\n        this.trigger('reset', view, this);\n      }\n    }\n    return this;\n  };\n\n  ViewCollection.prototype.renderOne = function(model) {\n    var view;\n    view = new this.view({\n      model: model\n    });\n    this.$el.append(view.render().el);\n    this.add(view);\n    return this;\n  };\n\n  ViewCollection.prototype.renderAll = function() {\n    this.collection.each(this.renderOne);\n    return this;\n  };\n\n  return ViewCollection;\n\n})(View);\n\nmethods = ['forEach', 'each', 'map', 'reduce', 'reduceRight', 'find', 'detect', 'filter', 'select', 'reject', 'every', 'all', 'some', 'any', 'include', 'contains', 'invoke', 'max', 'min', 'sortBy', 'sortedIndex', 'toArray', 'size', 'first', 'initial', 'rest', 'last', 'without', 'indexOf', 'shuffle', 'lastIndexOf', 'isEmpty', 'groupBy'];\n\n_.each(methods, function(method) {\n  return ViewCollection.prototype[method] = function() {\n    return _[method].apply(_, [this.views].concat(_.toArray(arguments)));\n  };\n});\n\nmodule.exports = ViewCollection;\n","var packHierarchy;\n\npackHierarchy = (function() {\n  function packHierarchy(data, options) {\n    var genderBalance, h, m, node, nodes, offset, pack, r, root, vis, w, x, y, zoom;\n    if (options == null) {\n      options = {};\n    }\n    m = Math.min($(window).width(), $(window).height());\n    w = h = r = m;\n    x = d3.scale.linear().range([0, r]);\n    y = d3.scale.linear().range([0, r]);\n    offset = options.offset || 0;\n    pack = d3.layout.pack().size([r, r]).value(function(d) {\n      return d.count || 0;\n    }).children(function(d) {\n      return d.values;\n    });\n    vis = d3.select(\"svg\").append(\"svg:g\").attr(\"class\", options[\"class\"]).attr(\"transform\", \"translate(\" + (w - r) / 2 + \",\" + (h - r) / 2 + \")\");\n    genderBalance = function(d) {\n      var ratio;\n      if ((d.values != null) || (d.countWomen == null) || (d.countWomen == null)) {\n        return \"#666\";\n      }\n      ratio = d.countMen / (d.countMen + d.countWomen);\n      return colorbrewer.RdBu[11][Math.floor(ratio * 11)];\n    };\n    node = root = data;\n    nodes = pack.nodes(root);\n    vis.selectAll(\"circle\").data(nodes).enter().append(\"svg:circle\").attr(\"class\", function(d) {\n      if (d.children) {\n        return \"parent\";\n      } else {\n        return \"child\";\n      }\n    }).style(\"fill\", function(d) {\n      return genderBalance(d);\n    }).attr(\"cx\", function(d) {\n      return d.x;\n    }).attr(\"cy\", function(d) {\n      return d.y;\n    }).attr(\"r\", function(d) {\n      return d.r;\n    }).on(\"click\", function(d) {\n      return zoom(d !== node ? d : root);\n    }).append(\"svg:title\").text(function(d) {\n      return d.label;\n    });\n    vis.selectAll(\"text\").data(nodes).enter().append(\"svg:text\").attr(\"class\", function(d) {\n      if (d.values) {\n        return \"parent\";\n      } else {\n        return \"child\";\n      }\n    }).attr(\"x\", function(d) {\n      return d.x;\n    }).attr(\"y\", function(d) {\n      return d.y;\n    }).attr(\"dy\", \".35em\").attr(\"text-anchor\", \"middle\").style(\"opacity\", function(d) {\n      if (d.r > 40 && d.depth === 1) {\n        return 1;\n      } else {\n        return 0;\n      }\n    }).text(function(d) {\n      return d.label;\n    });\n    zoom = function(d, i) {\n      var k, t;\n      console.info(d);\n      k = r / d.r / 2;\n      x.domain([d.x - d.r, d.x + d.r]);\n      y.domain([d.y - d.r, d.y + d.r]);\n      t = vis.transition().duration(750);\n      t.selectAll(\"circle\").attr(\"cx\", function(de) {\n        return x(de.x);\n      }).attr(\"cy\", function(de) {\n        return y(de.y);\n      }).attr(\"r\", function(de) {\n        return k * de.r;\n      });\n      t.selectAll(\"text\").attr(\"x\", function(de) {\n        return x(de.x);\n      }).attr(\"y\", function(de) {\n        return y(de.y);\n      }).style(\"opacity\", function(de) {\n        if (k * de.r > 30 && (de.depth === d.depth + 1 || !de.values)) {\n          return 1;\n        } else {\n          return 0;\n        }\n      });\n      node = d;\n      return d3.event.stopPropagation();\n    };\n    d3.select(window).on(\"click\", function() {\n      return zoom(root);\n    });\n  }\n\n  return packHierarchy;\n\n})();\n\nmodule.exports = packHierarchy;\n","var AppRouter,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nmodule.exports = AppRouter = (function(_super) {\n  __extends(AppRouter, _super);\n\n  function AppRouter() {\n    return AppRouter.__super__.constructor.apply(this, arguments);\n  }\n\n  AppRouter.prototype.routes = {\n    '': function() {}\n  };\n\n  return AppRouter;\n\n})(Backbone.Router);\n","var SceneKeeper,\n  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\nSceneKeeper = (function() {\n  var SHOW_STATS, geometryBuilder, imageRetriever, visualStructure;\n\n  visualStructure = require('./visualStructure');\n\n  geometryBuilder = require('./geometryBuilder');\n\n  imageRetriever = require('./imageRetriever');\n\n  SHOW_STATS = false;\n\n  function SceneKeeper() {\n    this.resize = __bind(this.resize, this);\n    this.updateArtistName = __bind(this.updateArtistName, this);\n    this.blankArtistName = __bind(this.blankArtistName, this);\n    this.mousemove = __bind(this.mousemove, this);\n    this.tweenCamera = __bind(this.tweenCamera, this);\n    this.keydown = __bind(this.keydown, this);\n    this.scanArtists = __bind(this.scanArtists, this);\n    this.keyup = __bind(this.keyup, this);\n    this.click = __bind(this.click, this);\n  }\n\n  SceneKeeper.prototype.init = function(data) {\n    this.data = data;\n    visualStructure.init(data);\n    this.initScene();\n    return geometryBuilder.build(this.scene, this.data);\n  };\n\n  SceneKeeper.prototype.initScene = function() {\n    var FAR, HEIGHT, MARGIN, SCREEN_HEIGHT, SCREEN_WIDTH, WIDTH, container, light;\n    this.scene = new THREE.Scene;\n    MARGIN = 0;\n    WIDTH = window.innerWidth || 2;\n    HEIGHT = window.innerHeight || (2 + 2 * MARGIN);\n    SCREEN_WIDTH = WIDTH;\n    SCREEN_HEIGHT = HEIGHT - 2 * MARGIN;\n    FAR = 10000;\n    this.camera = new THREE.PerspectiveCamera(35, SCREEN_WIDTH / SCREEN_HEIGHT, 0.1, FAR);\n    this.camera.position.set(-658, 366, 614);\n    this.controls = new THREE.TrackballControls(this.camera);\n    this.controls.rotateSpeed = 0.4;\n    this.controls.zoomSpeed = 0.7;\n    this.controls.panSpeed = 0.4;\n    this.controls.noZoom = false;\n    this.controls.noPan = false;\n    this.controls.staticMoving = false;\n    this.controls.dynamicDampingFactor = 0.3;\n    this.controls.keys = [49, 50, 51];\n    this.controls.target = new THREE.Vector3().set(-98, 128, -96);\n    this.controls.maxDistance = 1500;\n    this.controls.minDistance = 5;\n    this.scene.add(new THREE.AmbientLight(0x808080));\n    light = new THREE.SpotLight(0xffffff, 1.0);\n    light.position.set(170, 700, 0);\n    light.castShadow = true;\n    light.shadowCameraNear = 100;\n    light.shadowCameraFar = this.camera.far;\n    light.shadowCameraFov = 100;\n    light.shadowBias = -0.00122;\n    light.shadowDarkness = 0.1;\n    light.shadowMapWidth = 1024;\n    light.shadowMapHeight = 1024;\n    this.scene.add(light);\n    light = new THREE.SpotLight(0xffffff, 1.3);\n    light.position.set(0, -300, 100);\n    this.scene.add(light);\n    this.renderer = new THREE.WebGLRenderer({\n      antialias: true\n    });\n    this.renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);\n    this.renderer.setClearColor(new THREE.Color(0xD0D0D8));\n    this.renderer.shadowMapEnabled = true;\n    this.renderer.shadowMapType = THREE.PCFShadowMap;\n    this.renderer.sortObjects = false;\n    container = document.createElement('div');\n    document.body.appendChild(container);\n    container.appendChild(this.renderer.domElement);\n    if (SHOW_STATS) {\n      this.stats = new Stats();\n      this.stats.domElement.style.position = 'absolute';\n      this.stats.domElement.style.top = '0px';\n      this.stats.domElement.style.left = '0px';\n      container.appendChild(this.stats.domElement);\n    }\n    this.mouse = new THREE.Vector2();\n    this.projector = new THREE.Projector();\n    this.animate();\n    window.addEventListener('click', this.click, false);\n    window.addEventListener('mousemove', this.mousemove, false);\n    window.addEventListener('resize', this.resize, false);\n    window.addEventListener('resize', this.resize, false);\n    window.addEventListener('keydown', this.keydown, true);\n    window.addEventListener('keyup', this.keyup, true);\n    this.currentArtist = void 0;\n    return this.currentlyTyping = false;\n  };\n\n  SceneKeeper.prototype.click = function(event) {\n    var res;\n    if (Math.abs(window.mouseX - event.clientX) > 4 || Math.abs(window.mouseY - event.clientY) > 4) {\n      return;\n    }\n    res = this.findArtist(event);\n    if ((res != null) && res.artist.id === 3927) {\n      return;\n    }\n    if ((res == null) || this.currentArtist === res.artist) {\n      if (this.currentArtist) {\n        return this.blurArtist();\n      }\n    } else {\n      this.focusArtist(res.artist);\n      return this.currentlyTyping = false;\n    }\n  };\n\n  SceneKeeper.prototype.keyup = function(event) {\n    var artist, artists, binder, char, del, el, esc, _i, _len;\n    char = String.fromCharCode(event.keyCode);\n    del = event.keyCode === 8 || event.keyCode === 46;\n    esc = event.keyCode === 27;\n    if (((char < \"A\" || char > \"Z\") && char !== \" \") && !del && !esc) {\n      return;\n    }\n    if (esc) {\n      this.currentlyTyping = false;\n      this.blankArtistName();\n      this.blurArtist();\n      $('.escHint').slideUp(100);\n      return;\n    }\n    if (this.currentlyTyping === false) {\n      this.currentlyTyping = true;\n      this.blurArtist();\n      this.blankArtistName();\n      $('.escHint').slideDown(100);\n      $(\"h2\").text(\"_\");\n    }\n    if (!del) {\n      $(\"h2\").text($(\"h2\").text().slice(0, -1) + char + \"_\");\n    } else {\n      $(\"h2\").text($(\"h2\").text().slice(0, -2) + \"_\");\n    }\n    artists = this.scanArtists($(\"h2\").text().slice(0, -1));\n    $(\".works\").empty();\n    $(\".works\").append($(\"<p>&nbsp;</p>\"));\n    for (_i = 0, _len = artists.length; _i < _len; _i++) {\n      artist = artists[_i];\n      el = $(\"<a href=\\\"#\\\">\" + artist.firstname + \" \" + artist.lastname + \"</a>\");\n      binder = (function(_this) {\n        return function(artist) {\n          return $(el).on(\"click\", function(event) {\n            event.stopPropagation();\n            _this.currentlyTyping = false;\n            $('.escHint').slideUp(100);\n            return _this.focusArtist(_this.data.artists[artist.index]);\n          });\n        };\n      })(this);\n      binder(artist);\n      $(\".works\").append(el);\n    }\n    return false;\n  };\n\n  SceneKeeper.prototype.scanArtists = function(matchString) {\n    var artist, expression, i, len, matches, re, _i, _j, _len, _ref;\n    matchString = matchString.replace(/\\s/g, '');\n    matches = [];\n    if (matchString === \"\") {\n      return matches;\n    }\n    expression = \"\";\n    len = matchString.length - 1;\n    for (i = _i = 0; 0 <= len ? _i <= len : _i >= len; i = 0 <= len ? ++_i : --_i) {\n      expression += matchString.charAt(i) + \"+.?\";\n    }\n    re = new RegExp(expression, \"i\");\n    _ref = this.data.artists;\n    for (_j = 0, _len = _ref.length; _j < _len; _j++) {\n      artist = _ref[_j];\n      if (re.test(artist.firstname + artist.lastname)) {\n        matches.push(artist);\n      }\n      if (matches.length > 20) {\n        break;\n      }\n    }\n    return matches;\n  };\n\n  SceneKeeper.prototype.keydown = function(event) {\n    if (event.keyCode === 8 || event.keyCode === 46) {\n      event.preventDefault();\n      return false;\n    }\n    if ((this.currentArtist != null) && !this.currentTyping) {\n      switch (event.keyCode) {\n        case 37:\n        case 40:\n          if (this.currentArtist.index !== 0) {\n            return this.focusArtist(this.data.artists[this.currentArtist.index - 1]);\n          }\n          break;\n        case 39:\n        case 38:\n          if (this.currentArtist.index !== this.data.artists.length - 1) {\n            return this.focusArtist(this.data.artists[this.currentArtist.index + 1]);\n          }\n      }\n    }\n  };\n\n  SceneKeeper.prototype.blurArtist = function() {\n    var vec;\n    this.blankArtistName();\n    $(\".container h2\").removeClass(\"selected\");\n    if (this.currentArtist == null) {\n      return;\n    }\n    this.currentArtist = void 0;\n    this.removeHighlight();\n    vec = new THREE.Vector3();\n    vec.subVectors(this.camera.position, this.controls.target);\n    vec.setLength(vec.length() * 3);\n    vec.addVectors(vec, this.controls.target);\n    this.tweenCamera(vec, this.controls.target);\n    imageRetriever.clear();\n    $('.imageContainer').hide();\n    return this.currentArtistMesh = void 0;\n  };\n\n  SceneKeeper.prototype.removeHighlight = function() {\n    var tweenOut;\n    tweenOut = (function(_this) {\n      return function(mesh) {\n        return new TWEEN.Tween(_this.currentArtistMesh.material).to({\n          opacity: 0,\n          200: 200\n        }).easing(TWEEN.Easing.Exponential.Out).start().onComplete(function() {\n          return _this.scene.remove(mesh);\n        });\n      };\n    })(this);\n    return tweenOut(this.currentArtistMesh);\n  };\n\n  SceneKeeper.prototype.focusArtist = function(artist) {\n    var distToCenter, freshlyFocused, lookAt, mesh, oldLookAt, size, v, vec;\n    this.currentArtist = artist;\n    this.updateArtistName(this.currentArtist);\n    $(\".container h2\").addClass(\"selected\");\n    freshlyFocused = false;\n    if (this.currentArtistMesh) {\n      this.removeHighlight();\n    } else {\n      freshlyFocused = true;\n    }\n    mesh = geometryBuilder.selectedArtistMesh(artist);\n    this.scene.add(mesh);\n    this.currentArtistMesh = mesh;\n    oldLookAt = this.controls.target;\n    lookAt = artist.focusFace.centroid.clone();\n    v = new THREE.Vector3();\n    v.subVectors(lookAt, this.controls.target);\n    size = 1 + artist._height * 260;\n    distToCenter = size / Math.sin(Math.PI / 180.0 * this.camera.fov * 0.5);\n    vec = new THREE.Vector3();\n    vec.subVectors(this.camera.position, oldLookAt);\n    if (freshlyFocused) {\n      vec.setLength(distToCenter);\n    }\n    vec.addVectors(vec, lookAt);\n    this.tweenCamera(vec, lookAt);\n    if ((new Date().getFullYear() - artist.dod) > Math.floor(22.281692032865347 * Math.PI)) {\n      return imageRetriever.getImages(artist);\n    } else {\n      return $('.imageContainer').hide();\n    }\n  };\n\n  SceneKeeper.prototype.tweenCamera = function(position, target) {\n    new TWEEN.Tween(this.camera.position).to({\n      x: position.x,\n      y: position.y,\n      z: position.z\n    }, 700).easing(TWEEN.Easing.Exponential.Out).start();\n    return new TWEEN.Tween(this.controls.target).to({\n      x: target.x,\n      y: target.y,\n      z: target.z\n    }, 700).easing(TWEEN.Easing.Exponential.Out).start();\n  };\n\n  SceneKeeper.prototype.findArtist = function(event) {\n    var artist, face, intersects, ray, res, vector;\n    this.mouse.x = (event.clientX / window.innerWidth) * 2 - 1;\n    this.mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;\n    vector = new THREE.Vector3(this.mouse.x, this.mouse.y, 0.5);\n    this.projector.unprojectVector(vector, this.camera);\n    ray = new THREE.Raycaster(this.camera.position, vector.sub(this.camera.position).normalize());\n    intersects = ray.intersectObjects(this.scene.children);\n    if (intersects.length > 0) {\n      face = intersects[0].face;\n      artist = this.data.artistsKeyed[face.color.r];\n      res = {\n        object: intersects[0],\n        artist: artist,\n        face: face\n      };\n      return res;\n    }\n    return void 0;\n  };\n\n  SceneKeeper.prototype.mousemove = function(event) {\n    var res;\n    if ((this.currentArtist != null) || this.currentlyTyping) {\n      return;\n    }\n    res = this.findArtist(event);\n    if (res != null) {\n      return this.updateArtistName(res.artist);\n    } else {\n      return this.blankArtistName();\n    }\n  };\n\n  SceneKeeper.prototype.blankArtistName = function() {\n    $('.container h2').html(\"\");\n    return $('.container p').text(\"\");\n  };\n\n  SceneKeeper.prototype.updateArtistName = function(artist) {\n    var dod, workLen, workNoun;\n    $('.container h2').text(artist.firstname + \" \" + artist.lastname);\n    dod = artist.dod === 2013 ? \"\" : artist.dod;\n    $('.container p.lifespan').text(artist.dob + \" - \" + dod);\n    workLen = artist.works.length;\n    workNoun = artist.works.length > 1 ? \"works\" : \"work\";\n    return $('.container p.works').text(workLen + \" \" + workNoun + \" in collection\");\n  };\n\n  SceneKeeper.prototype.animate = function() {\n    this.render();\n    if (SHOW_STATS) {\n      this.stats.update();\n    }\n    if (!this.stopped) {\n      requestAnimationFrame((function(_this) {\n        return function() {\n          return _this.animate();\n        };\n      })(this));\n    }\n    TWEEN.update();\n    return this.controls.update();\n  };\n\n  SceneKeeper.prototype.render = function() {\n    return this.renderer.render(this.scene, this.camera);\n  };\n\n  SceneKeeper.prototype.resize = function() {\n    var SCREEN_HEIGHT, SCREEN_WIDTH;\n    SCREEN_WIDTH = window.innerWidth;\n    SCREEN_HEIGHT = window.innerHeight;\n    this.renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);\n    this.camera.aspect = SCREEN_WIDTH / SCREEN_HEIGHT;\n    return this.camera.updateProjectionMatrix();\n  };\n\n  return SceneKeeper;\n\n})();\n\nmodule.exports = new SceneKeeper;\n","var AppRouter, AppView, View,\n  __hasProp = {}.hasOwnProperty,\n  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\n\nView = require('../lib/view');\n\nAppRouter = require('../routers/app_router');\n\nmodule.exports = AppView = (function(_super) {\n  __extends(AppView, _super);\n\n  function AppView() {\n    return AppView.__super__.constructor.apply(this, arguments);\n  }\n\n  AppView.prototype.el = 'body.application';\n\n  AppView.prototype.initialize = function() {\n    var _ref;\n    this.router = new AppRouter();\n    return typeof Hipster !== \"undefined\" && Hipster !== null ? (_ref = Hipster.Routers) != null ? _ref.AppRouter = this.router : void 0 : void 0;\n  };\n\n  return AppView;\n\n})(View);\n","var VisualStructure;\n\nVisualStructure = (function() {\n  function VisualStructure() {}\n\n  VisualStructure.prototype.init = function(data) {\n    var workHeight, workIndex;\n    this.data = data;\n    this.tracks = [];\n    console.info(\"Tally\");\n    console.info(\"Number of artists: \" + this.data.artists.length);\n    console.info(\"Number of works: \" + this.data.works.length);\n    this.startYear = this.data.artists[0].dob;\n    this.endYear = new Date().getFullYear();\n    console.info(\"Normalizing against: \" + this.startYear + \" - \" + this.endYear);\n    this.numberOfWorks = this.data.works.length / 10;\n    console.info(\"Allocating artist space\");\n    workHeight = 1 / this.numberOfWorks;\n    workIndex = -0.5;\n    this.data.artists.forEach((function(_this) {\n      return function(artist) {\n        var height, width, x;\n        height = artist.works.length / _this.numberOfWorks;\n        x = _this.yearToFloat(artist.dob);\n        width = _this.yearToFloat(artist.dod) - x;\n        artist._x = x - 0.5 + (width / 2);\n        artist._y = workIndex + height / 2;\n        artist._height = height;\n        artist._width = width;\n        artist.works.forEach(function(work, i) {\n          var wHeight, wWidth, wX, wY;\n          if (!work.invalid) {\n            wHeight = workHeight;\n            wX = _this.yearToFloat(work.produced);\n            wWidth = _this.yearToFloat(work.acquired) - wX;\n            wY = workIndex + (workHeight * i);\n            work._x = wX - 0.5 + (wWidth / 2);\n            work._y = wY + wHeight / 2;\n            work._height = wHeight;\n            return work._width = wWidth;\n          }\n        });\n        return workIndex += height + workHeight * 0;\n      };\n    })(this));\n    console.info(\"Done\");\n    return this.data;\n  };\n\n  VisualStructure.prototype.yearToFloat = function(year) {\n    return (year - this.startYear) / (this.endYear - this.startYear);\n  };\n\n  return VisualStructure;\n\n})();\n\nmodule.exports = new VisualStructure;\n"]}